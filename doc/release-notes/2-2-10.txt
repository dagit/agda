------------------------------------------------------------------------
-- Release notes for Agda 2 version 2.2.10
------------------------------------------------------------------------

Important changes since 2.2.8:

Language
--------

* Irrelevant declarations.

  Prefixing the type signature of a postulate or a function marks 
  this identifier as irrelevant which means it can only be refered
  to in irrelevant positions or in other irrelevant declarations.

    postulate
      .irrelevant : {A : Set} → .A → A

  This axiom can be used for instance to define a projection from
  an irrelevant record field.

    data Subset (A : Set) (P : A → Set) : Set where
      _#_ : (elem : A) → .(P elem) → Subset A P

    .certificate : ∀ {A P} → (x : Subset A P) → P (elem x)
    certificate (a # p) = irrelevant p

  Right to = we are in relevant position, so we cannot directly put p
  there.  However, since certificate is declared irrelevant, it can 
  use other irrelevant declarations, in particular the axiom irrelevant,
  whose argument p is now in irrelevant position.

  The above axiom justifies irrelevant projections, hence for record
  defintitions like

    record Subset (A : Set) (P : A → Set) : Set where
      constructor _#_
      field
        elem : A
        .certificate : P elem

  they are generated automatically, if the option

    --irrelevant-projections

  is supplied.  Irrelevant projections are highly experimental.

* Termination checker recognizes projections.

  Projections now preserve sizes, both in patterns and expressions.
  Example:

    record Wrap (A : Set) : Set where
      constructor wrap
      field
        unwrap : A

    open Wrap public

    data WNat : Set where
      zero : WNat
      suc  : Wrap WNat → WNat

    id : WNat → WNat
    id zero    = zero
    id (suc w) = suc (wrap (id (unwrap w)))

  In the structural ordering unwrap w ≤ w. This means that

    unwrap w ≤ w < suc w,

  and hence the recursive call to id is accepted.

  Projections also preserve guardedness.

Tools
-----

* Most occurrences of record field names are now highlighted as
  "fields". Previously many occurrences were highlighted as
  "functions".

* Emacs mode: It is no longer possible to change the behaviour of the
  TAB key by customising agda2-indentation.
